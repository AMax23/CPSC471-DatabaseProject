DROP DATABASE IF EXISTS ChildDaycare;

CREATE DATABASE ChildDaycare;

USE ChildDaycare;


DROP TABLE IF EXISTS DAYCARE;
CREATE TABLE DAYCARE (
     DAYCARENAME VARCHAR(100) NOT NULL
   , DAYCAREADDRESS VARCHAR(100) NOT NULL
   , TOTALNUMOFCARETAKERS INT
   , CONSTRAINT PK_DAYCARE PRIMARY KEY (DAYCARENAME, DAYCAREADDRESS)
);

DROP TABLE IF EXISTS ROOM;
CREATE TABLE ROOM (
	DAYCARENAME VARCHAR(100) NOT NULL,
	DAYCAREADDRESS VARCHAR(100) NOT NULL,
	ROOMID INT NOT NULL,
	SIZE INT NOT NULL,
	SEATSAVAILABLE INT NOT NULL,
	CONSTRAINT PK_ROOM PRIMARY KEY (DAYCARENAME, DAYCAREADDRESS, ROOMID),
	FOREIGN KEY (DAYCARENAME) REFERENCES DAYCARE (DAYCARENAME)
	,FOREIGN KEY (DAYCAREADDRESS) REFERENCES DAYCARE (DAYCAREADDRESS)
);

CREATE TABLE IF NOT EXISTS PERSON (
     SIN VARCHAR(8) NOT NULL
   , FIRSTNAME VARCHAR(30)
   , LASTNAME VARCHAR(30)
   , GENDER VARCHAR(30)
   , ADDRUNITNUM INT
   , ADDRCITY VARCHAR(20)
   , ADDRPOSTALCODE VARCHAR(20)
   , STARTDAY VARCHAR(10)
   , STARTMONTH VARCHAR(9)
   , CONSTRAINT PK_PERSON PRIMARY KEY (SIN)
);

DROP TABLE IF EXISTS PERSON_PHONE;
CREATE TABLE PERSON_PHONE (
	SIN VARCHAR(8) NOT NULL,
	PHONENUM VARCHAR(20) NOT NULL,
	CONSTRAINT PK_PERSONPHONE PRIMARY KEY (SIN, PHONENUM),
	CONSTRAINT FOREIGN KEY (SIN) REFERENCES PERSON (SIN)
);

DROP TABLE IF EXISTS EMPLOYEE;
CREATE TABLE EMPLOYEE (
	DAYCARENAME VARCHAR(100) NOT NULL,
	DAYCAREADDRESS VARCHAR(100) NOT NULL,
	SIN VARCHAR(8) NOT NULL,
	EMPLOYEEID INT NOT NULL,
	WORKHOURS DECIMAL(4,2),
	CONSTRAINT PK_EMPLOYEE PRIMARY KEY (DAYCARENAME, DAYCAREADDRESS, SIN, EMPLOYEEID),
	CONSTRAINT DAYCARENAME FOREIGN KEY (DAYCARENAME) REFERENCES DAYCARE (DAYCARENAME),
	CONSTRAINT DAYCAREADDRESS FOREIGN KEY (DAYCAREADDRESS) REFERENCES DAYCARE (DAYCAREADDRESS),
	CONSTRAINT FOREIGN KEY (SIN) REFERENCES PERSON (SIN)
);

DROP TABLE IF EXISTS ADMIN;
CREATE TABLE ADMIN (
	SIN VARCHAR(8) NOT NULL,
	EMPLOYEEID INT NOT NULL,
	CONSTRAINT PK_ADMIN PRIMARY KEY (SIN, EMPLOYEEID),
	CONSTRAINT FOREIGN KEY (SIN) REFERENCES PERSON (SIN),
	CONSTRAINT EMPLOYEEID FOREIGN KEY (EMPLOYEEID) REFERENCES EMPLOYEE (EMPLOYEEID)
);

DROP TABLE IF EXISTS CARETAKER;
CREATE TABLE CARETAKER (
	SIN VARCHAR(8) NOT NULL,
	EMPLOYEEID INT NOT NULL,
	AVAILABILITY BOOLEAN,
	CONSTRAINT PK_CARETAKER PRIMARY KEY (SIN, EMPLOYEEID),
	CONSTRAINT FOREIGN KEY (SIN) REFERENCES PERSON (SIN),
	CONSTRAINT FOREIGN KEY (EMPLOYEEID) REFERENCES EMPLOYEE (EMPLOYEEID)
);

DROP TABLE IF EXISTS CARETAKER_SPECIALIZATION;
CREATE TABLE CARETAKER_SPECIALIZATION (
	CARETAKERSIN VARCHAR(8) NOT NULL,
	SPECIALIZATIONTYPE VARCHAR(100) NOT NULL,
	CONSTRAINT PK_CSPEC PRIMARY KEY (CARETAKERSIN, SPECIALIZATIONTYPE),
	CONSTRAINT CARETAKERSIN FOREIGN KEY (CARETAKERSIN) REFERENCES CARETAKER (SIN)
);

DROP TABLE IF EXISTS BILL;
CREATE TABLE BILL (
	BILLID INT NOT NULL,
	CREATEDBYID INT NOT NULL,
	PAYMENTMETHOD VARCHAR(30),
	AMOUNTPENDING DECIMAL(6,2) NOT NULL,
	CONSTRAINT PK_BILL PRIMARY KEY (BILLID, CREATEDBYID),
	CONSTRAINT CREATEDBYID FOREIGN KEY (CREATEDBYID) REFERENCES ADMIN (EMPLOYEEID)
);

DROP TABLE IF EXISTS PARENT_GUARDIAN;
CREATE TABLE PARENT_GUARDIAN (
	SIN VARCHAR(8) NOT NULL,
	CARETAKEREMPLOYEEID INT,
	BILLID INT,
	CONSTRAINT PK_PARENT PRIMARY KEY (SIN, CARETAKEREMPLOYEEID, BILLID),
	CONSTRAINT FOREIGN KEY (SIN) REFERENCES PERSON (SIN),
	CONSTRAINT CARETAKEREMPLOYEEID FOREIGN KEY (CARETAKEREMPLOYEEID) REFERENCES CARETAKER (EMPLOYEEID),
	CONSTRAINT BILLID FOREIGN KEY (BILLID) REFERENCES BILL (BILLID)
);

DROP TABLE IF  EXISTS CHILD;
CREATE TABLE CHILD (
	SIN VARCHAR(8) NOT NULL,
	CARETAKEREMPLOYEEID INT NOT NULL,
	PARENTSIN VARCHAR(8) NOT NULL,
	DATEOFBIRTH DATE NOT NULL,
	CONSTRAINT PK_CHILD PRIMARY KEY (SIN, CARETAKEREMPLOYEEID, PARENTSIN,ROOMID),
	CONSTRAINT FOREIGN KEY (SIN) REFERENCES PERSON (SIN),
	CONSTRAINT FOREIGN KEY (CARETAKEREMPLOYEEID) REFERENCES CARETAKER (EMPLOYEEID),
	CONSTRAINT FOREIGN KEY (PARENTSIN) REFERENCES PARENT_GUARDIAN (SIN),
	CONSTRAINT FOREIGN KEY (ROOMID) REFERENCES ROOM (ROOMID)
);

DROP TABLE IF EXISTS CONDITIONS;
CREATE TABLE CONDITIONS (
	CHILDSIN VARCHAR(8) NOT NULL,
	CONDITIONNAME VARCHAR(100) NOT NULL,
	CONDITIONTREATMENT VARCHAR(100) NOT NULL,
	CONSTRAINT PK_CONDITION PRIMARY KEY (CHILDSIN, CONDITIONNAME, CONDITIONTREATMENT),
	CONSTRAINT FOREIGN KEY (CHILDSIN) REFERENCES CHILD (SIN)
);

DROP TABLE IF EXISTS WAITLIST;
CREATE TABLE WAITLIST (
	CHILDNAME VARCHAR(30) NOT NULL,
	FAMILYNAME VARCHAR(30) NOT NULL,
	SUBMITTEDBYID INT NOT NULL,
	CONSTRAINT PK_WAITLIST PRIMARY KEY (CHILDNAME, FAMILYNAME, SUBMITTEDBYID),
	CONSTRAINT SUBMITTEDBYID FOREIGN KEY (SUBMITTEDBYID) REFERENCES ADMIN (EMPLOYEEID)
);

DROP TABLE IF EXISTS DAILY_REPORT;
CREATE TABLE DAILY_REPORT (
	CHILDSIN VARCHAR(8) NOT NULL,
	REPORTID INT NOT NULL,	
	CARETAKEREMPLOYEEID INT NOT NULL,	
	REPORTDATE DATE NOT NULL,
	STARTTIME DATETIME,
	ENDTIME DATETIME,
	REPORTCOMMENT VARCHAR(100),
	CONSTRAINT PK_REPORT PRIMARY KEY (CHILDSIN, DATE, REPORTID, CARETAKEREMPLOYEEID),
	CONSTRAINT CHILDSIN FOREIGN KEY (CHILDSIN) REFERENCES CHILD (SIN),
	CONSTRAINT CARETAKERID FOREIGN KEY (CARETAKEREMPLOYEEID) REFERENCES CARETAKER (EMPLOYEEID)
);

DROP TABLE IF EXISTS INCIDENTS;
CREATE TABLE INCIDENTS (
	REPORTID INT NOT NULL,
	ACTIONREQUIRED VARCHAR(100),
	CONSTRAINT PK_INCID PRIMARY KEY (REPORTID),
	CONSTRAINT FOREIGN KEY (REPORTID) REFERENCES DAILY_REPORT (REPORTID)
);

DROP TABLE IF EXISTS ACTIVITIES;
CREATE TABLE ACTIVITIES (
	REPORTID INT NOT NULL,
	LESSONSLEARNED VARCHAR(100),
	CONSTRAINT PK_ACT PRIMARY KEY (REPORTID),
	CONSTRAINT FOREIGN KEY (REPORTID) REFERENCES DAILY_REPORT (REPORTID)
);




INSERT INTO PERSON VALUES (123456789, 'Erin Employee', 'Female', '123 Calgary Drive',STR_TO_DATE('09,07,2003', '%d, %m, %Y')),(111222333, 'Joe Fresh', 'Male','Also Clagary Dr',STR_TO_DATE('12,10,2008', '%d, %m, %Y')), (111111111, 'First Child', 'Female', 'Home address',STR_TO_DATE('19,07,2011', '%d, %m, %Y')), (111111112, 'Child Parent', 'Male', 'Home address',STR_TO_DATE('09,07,2003', '%d, %m, %Y')), (999888777, 'Admin Lady', 'Female', 'The Daycare St',STR_TO_DATE('29,10,2008','%d, %m, %Y')), (555666777, 'A Child Person', 'Male', 'Also Clagary Dr', STR_TO_DATE('12,10,2008', '%d, %m, %Y')), (444333222, 'Dr Employee', 'Male', 'The Mansion', STR_TO_DATE('10,10,2010','%d, %m, %Y'));

INSERT INTO DAYCARE VALUES ('Daycare One', 'Daycare Street NW', 5), ('Daycare Two', 'Other Daycare Street', 30);

INSERT INTO ROOM VALUES ('Daycare One', 'Daycare Street NW', 1, 5), ('Daycare Two', 'Other Daycare Street', 1, 10), ('Daycare One', 'Daycare Street NW', 2, 3);

INSERT INTO PERSON_PHONE VALUES (123456789, '4035551234'), (123456789, '4035551223'), (111222333, '4035556543'), (111111112, '1234567890'), (999888777,'1233334444'), (444333222, '4039999911');

INSERT INTO EMPLOYEE VALUES ('Daycare One', 'Daycare Street NW', 123456789, 5555, '9-5 M-F'), ('Daycare One', 'Daycare Street NW', 444333222, 5550, 'Weekends'), ('Daycare One', 'Daycare Street NW', 999888777, 1234, 'On Call');

INSERT INTO CARETAKER VALUES (123456789, 5555, 'Unavailable Sundays'), (444333222, 5550, 'Weekends');

INSERT INTO ADMIN VALUES (999888777, 1234);

INSERT INTO BILL VALUES (12345, 1234, 'MasterCard', 0), (43434, 1234, NULL, 300);

INSERT INTO WAITLIST VALUES ('Possible New Child', 'Theior Family', 1234), ('Evil Child', 'Nice Family', 1234);

INSERT INTO CARETAKER_SPECIALIZATION VALUES (123456789, 'Eating Disorders'), (123456789, 'Healthy Eating'), (444333222, 'Trauma'), (444333222, 'OCD');

INSERT INTO PARENT_GUARDIAN VALUES (111222333, 5555, 12345), (111111112, 5550, 43434);

INSERT INTO CHILD VALUES (111111111, 5555, 111222333, 1, STR_TO_DATE('12,10,2005', '%d, %m, %Y')), (555666777, 5550, 111111112, 2, STR_TO_DATE('06,06,2007','%d, %m, %Y'));

INSERT INTO CONDITIONS VALUES (111111111, 'Celiac Disease', 'Gluten Free Diet'), (111111111, 'Asthma', 'Inhaler'), (555666777, 'Asthma', 'Inhaler'), (555666777, 'OCD', 'Monitor Actions');

INSERT INTO DAILY_REPORT VALUES (111111111, STR_TO_DATE('01,01,2020','%d, %m, %Y'), 1, 5555, '2020-01-01 10:10:10', '2020-01-01 10:15:10', 'Good job child'), (555666777, STR_TO_DATE('01,01,2020','%d, %m, %Y'), 2, 5550, '2020-01-01 10:05:10', '2020-01-01 10:20:10', 'Bad child');

INSERT INTO INCIDENTS VALUES (2, 'Needs to be talked to about behaviour');

INSERT INTO ACTIVITIES VALUES (1, 'Learned about space');